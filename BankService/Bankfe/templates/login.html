<html>
<head>
	<title>Login</title>  
</head>
<script>
	function loginRequest(){
		let url = "/login-request";
		let xhr = new XMLHttpRequest();
		let usn = document.getElementById("username").value.toString();
		let psw = document.getElementById("password").value.toString();
		let requestBody = {
			"username" : usn,
			"password" : psw,
			"bill" : {{bill}},
			"to_user" : {{to_user}},
			"id_order" : {{id_order}}
		}
		
		xhr.open("POST", url, true);
		xhr.setRequestHeader('Content-Type', 'application/json');
		xhr.send(JSON.stringify(requestBody));
		xhr.onreadystatechange = function (){
			if(xhr.readyState === XMLHttpRequest.DONE){
				const status = xhr.status;
				console.log(xhr.responseText);
				if(status === 0 || (status >= 200 && status < 400)){
					//get json responseText
					var response = JSON.parse(xhr.responseText);
					//if succesfull = true => go to next bank page
					if(response.success){
						//jolie ritorner√† direttamente l'url completo
						document.location.href = response.url;
					} else {
						//else show error
						alert("credenziali errate");
					}
				}
			}
			
			
		}
	}
</script>
<body>
	<h1>LOGIN</h1>
	<label for="username">Username</label>
	<input type="text" name="username" placeholder="username" id="username" >
	<label for="password">Password</label>
	<input type="password" name="password" id="password">
	<button onclick="loginRequest()">LOGIN</button>
</body>
</html>